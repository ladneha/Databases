SELECT ID, CASE WHEN P_ID IS NULL THEN 'Root' WHEN ID NOT IN (SELECT P_ID FROM Tree WHERE P_ID IS NOT NULL ) THEN 'Leaf' ELSE 'Inner' END FROM Tree t ORDER BY ID;